/* const search = {
    "data": [
        {
            "id": "swsh6-181",
            "name": "Metagross V",
            "supertype": "Pokémon",
            "subtypes": [
                "Basic",
                "V",
                "Rapid Strike"
            ],
            "hp": "220",
            "types": [
                "Metal"
            ],
            "rules": [
                "V rule: When your Pokémon V is Knocked Out, your opponent takes 2 Prize cards."
            ],
            "attacks": [
                {
                    "name": "Bullet Punch",
                    "cost": [
                        "Metal"
                    ],
                    "convertedEnergyCost": 1,
                    "damage": "20+",
                    "text": "Flip 2 coins. This attack does 20 more damage for each heads."
                },
                {
                    "name": "Synchro Hammer",
                    "cost": [
                        "Metal",
                        "Colorless"
                    ],
                    "convertedEnergyCost": 2,
                    "damage": "60+",
                    "text": "If this Pokémon and your opponent's Active Pokémon have the same amount of Energy attached, this attack does 90 more damage."
                }
            ],
            "weaknesses": [
                {
                    "type": "Fire",
                    "value": "×2"
                }
            ],
            "resistances": [
                {
                    "type": "Grass",
                    "value": "-30"
                }
            ],
            "retreatCost": [
                "Colorless",
                "Colorless",
                "Colorless"
            ],
            "convertedRetreatCost": 3,
            "set": {
                "id": "swsh6",
                "name": "Chilling Reign",
                "series": "Sword & Shield",
                "printedTotal": 198,
                "total": 233,
                "legalities": {
                    "unlimited": "Legal",
                    "standard": "Legal",
                    "expanded": "Legal"
                },
                "ptcgoCode": "CRE",
                "releaseDate": "2021/06/18",
                "updatedAt": "2021/06/18 12:12:00",
                "images": {
                    "symbol": "https://images.pokemontcg.io/swsh6/symbol.png",
                    "logo": "https://images.pokemontcg.io/swsh6/logo.png"
                }
            },
            "number": "181",
            "artist": "PLANETA Mochizuki",
            "rarity": "Rare Ultra",
            "nationalPokedexNumbers": [
                376
            ],
            "legalities": {
                "unlimited": "Legal",
                "standard": "Legal",
                "expanded": "Legal"
            },
            "regulationMark": "E",
            "images": {
                "small": "https://images.pokemontcg.io/swsh6/181.png",
                "large": "https://images.pokemontcg.io/swsh6/181_hires.png"
            },
            "tcgplayer": {
                "url": "https://prices.pokemontcg.io/tcgplayer/swsh6-181",
                "updatedAt": "2024/03/29",
                "prices": {
                    "holofoil": {
                        "low": 1.5,
                        "mid": 2.9,
                        "high": 19.95,
                        "market": 2.79,
                        "directLow": 2.99
                    }
                }
            },
            "cardmarket": {
                "url": "https://prices.pokemontcg.io/cardmarket/swsh6-181",
                "updatedAt": "2024/03/29",
                "prices": {
                    "averageSellPrice": 3.46,
                    "lowPrice": 2.5,
                    "trendPrice": 3.07,
                    "germanProLow": 0,
                    "suggestedPrice": 0,
                    "reverseHoloSell": 0,
                    "reverseHoloLow": 0,
                    "reverseHoloTrend": 0,
                    "lowPriceExPlus": 2.5,
                    "avg1": 4,
                    "avg7": 3.5,
                    "avg30": 3.59,
                    "reverseHoloAvg1": 0,
                    "reverseHoloAvg7": 0,
                    "reverseHoloAvg30": 0
                }
            }
        },
        {
            "id": "swsh6-112",
            "name": "Metagross V",
            "supertype": "Pokémon",
            "subtypes": [
                "Basic",
                "V",
                "Rapid Strike"
            ],
            "hp": "220",
            "types": [
                "Metal"
            ],
            "rules": [
                "V rule: When your Pokémon V is Knocked Out, your opponent takes 2 Prize cards."
            ],
            "attacks": [
                {
                    "name": "Bullet Punch",
                    "cost": [
                        "Metal"
                    ],
                    "convertedEnergyCost": 1,
                    "damage": "20+",
                    "text": "Flip 2 coins. This attack does 20 more damage for each heads."
                },
                {
                    "name": "Synchro Hammer",
                    "cost": [
                        "Metal",
                        "Colorless"
                    ],
                    "convertedEnergyCost": 2,
                    "damage": "60+",
                    "text": "If this Pokémon and your opponent's Active Pokémon have the same amount of Energy attached, this attack does 90 more damage."
                }
            ],
            "weaknesses": [
                {
                    "type": "Fire",
                    "value": "×2"
                }
            ],
            "resistances": [
                {
                    "type": "Grass",
                    "value": "-30"
                }
            ],
            "retreatCost": [
                "Colorless",
                "Colorless",
                "Colorless"
            ],
            "convertedRetreatCost": 3,
            "set": {
                "id": "swsh6",
                "name": "Chilling Reign",
                "series": "Sword & Shield",
                "printedTotal": 198,
                "total": 233,
                "legalities": {
                    "unlimited": "Legal",
                    "standard": "Legal",
                    "expanded": "Legal"
                },
                "ptcgoCode": "CRE",
                "releaseDate": "2021/06/18",
                "updatedAt": "2021/06/18 12:12:00",
                "images": {
                    "symbol": "https://images.pokemontcg.io/swsh6/symbol.png",
                    "logo": "https://images.pokemontcg.io/swsh6/logo.png"
                }
            },
            "number": "112",
            "artist": "PLANETA Mochizuki",
            "rarity": "Rare Holo V",
            "nationalPokedexNumbers": [
                376
            ],
            "legalities": {
                "unlimited": "Legal",
                "standard": "Legal",
                "expanded": "Legal"
            },
            "regulationMark": "E",
            "images": {
                "small": "https://images.pokemontcg.io/swsh6/112.png",
                "large": "https://images.pokemontcg.io/swsh6/112_hires.png"
            },
            "tcgplayer": {
                "url": "https://prices.pokemontcg.io/tcgplayer/swsh6-112",
                "updatedAt": "2024/03/29",
                "prices": {
                    "holofoil": {
                        "low": 0.35,
                        "mid": 0.88,
                        "high": 7.48,
                        "market": 0.76,
                        "directLow": 0.99
                    }
                }
            },
            "cardmarket": {
                "url": "https://prices.pokemontcg.io/cardmarket/swsh6-112",
                "updatedAt": "2024/03/29",
                "prices": {
                    "averageSellPrice": 1.02,
                    "lowPrice": 0.49,
                    "trendPrice": 0.84,
                    "germanProLow": 0,
                    "suggestedPrice": 0,
                    "reverseHoloSell": 0,
                    "reverseHoloLow": 0,
                    "reverseHoloTrend": 0,
                    "lowPriceExPlus": 0.49,
                    "avg1": 0.87,
                    "avg7": 0.83,
                    "avg30": 0.98,
                    "reverseHoloAvg1": 0,
                    "reverseHoloAvg7": 0,
                    "reverseHoloAvg30": 0
                }
            }
        }
    ],
    "page": 1,
    "pageSize": 250,
    "count": 2,
    "totalCount": 2

} */

//Creo variable vacía con mis resultados del fetch
let searchResults = {}

function printSearchResults(search) {
    document.querySelector("#search-results").innerHTML = "";
    let arrayList = []
    for (let i = 0; i < search.data.length; i++) {
        let card = `<section class="card-container">
                        <img src=${search.data[i].images.small} class="card-image"/>
                        <button id="${search.data[i].id}" class="open-modal-button">Ampliar</button>
                    </section>`;
        document.querySelector("#search-results").innerHTML += card
        arrayList.push(search.data[i].id)
    }
    console.log(arrayList)
    arrayList.map(id => {
        document.getElementById(`${id}`).addEventListener("click", function (event) {
            let modal = document.getElementById("modal-box");
            modal.style.display = "block";
            let cardToPrint = searchResults.data.filter(elem => elem.id == id)
            console.log(cardToPrint);
            //Llamada a la función que pinta la tarjeta en el Modal con argumento = cardToPrint
        })
    })

};

document.querySelector("form").addEventListener("submit", function (event) {
    event.preventDefault();

    //Valores de los input
    let cardName = document.getElementById("search-input").value;
    console.log(document.getElementById("search-input").value);
    let formatValue = document.getElementById("format").value;
    console.log(document.getElementById("format").value);
    let supertypesValue = document.getElementById("supertypes").value;
    console.log(document.getElementById("supertypes").value);


    //Filtros para la búsqueda
    let filterFormat = "";
    let filterSupertypes = "";

    if (supertypesValue == "Pokémon") {
        filterSupertypes = "supertype:pokemon"
    } else if (supertypesValue == "Entrenadores") {
        filterSupertypes = "supertype:trainer"
    } else if (supertypesValue == "Energías") {
        filterSupertypes = "supertype:energy"
    } else filterSupertypes = "";

    if (formatValue == "Estándar") {
        filterFormat = "legalities.standard:legal"
    } else if (formatValue == "Expandido") {
        filterFormat = "legalities.expanded:legal"
    } else if (formatValue == "Unlimited") {
        filterFormat = "legalities.unlimited:legal"
    } else filterFormat = "legalities.unlimited:legal";



    console.log(`https://api.pokemontcg.io/v2/cards?q=name:"${cardName}" ${filterSupertypes} ${filterFormat}&orderBy=-set.releaseDate`);

    fetch(`https://api.pokemontcg.io/v2/cards?q=name:"${cardName}" ${filterSupertypes} ${filterFormat}&orderBy=-set.releaseDate`)
        .then(res => res.json())
        .catch((error) => console.error("Error:", error))
        .then(search => {
            searchResults = search;
            printSearchResults(searchResults)
        })
});




// Ventana modal
let modal = document.getElementById("modal-box");
console.log(modal)

// Hace referencia al elemento <span> que tiene la X que cierra la ventana
let span = document.getElementById("close-modal");
console.log(span);

// Si el usuario hace click en la x, la ventana se cierra
span.addEventListener("click", function () {
    modal.style.display = "none";
    console.log("Hey existo")
});

// Si el usuario hace click fuera de la ventana, se cierra.
window.addEventListener("click", function (event) {
    if (event.target == modal) {
        modal.style.display = "none";
        console.log("Hey funciono")
    }
});



/* function displayModalBox() {
    let data = `<div id="modal-box" class="modal">
                <div class="modal-content">
                    <span id="close-modal">&times;</span>
                    <h2>Ventana modal</h2>
                    <p>Esto es el texto de la ventana</p>
                </div>
            </div>`
    document.getElementById("search-results").innerHTML += data

    // Ventana modal
    let modal = document.getElementById("modal-box");

    // Hace referencia al elemento <span> que tiene la X que cierra la ventana
    let span = document.getElementById("close-modal");

    // Si el usuario hace click en la x, la ventana se cierra
    span.addEventListener("click", function () {
        modal.style.display = "none";
    });

    // Si el usuario hace click fuera de la ventana, se cierra.
    window.addEventListener("click", function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    });
} */
//printSearchResults(search)